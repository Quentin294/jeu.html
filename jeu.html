<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Mode Classique - Prototype</title>
  <style>
    body { margin:0; background:#1a1d2b; font-family:Arial,sans-serif; overflow:hidden;}
    #gameArea {
      position:relative; width:900px; height:600px; margin:40px auto; background:#232b3b;
      border-radius:20px; box-shadow:0 8px 32px #000a; overflow:hidden;
    }
    .player, .enemy, .coin, .xp-bubble {
      position:absolute; border-radius:50%;
      transition: box-shadow 0.1s;
    }
    .player {
      width:48px; height:48px; background:#3a6ee8;
      border:3px solid #fff; box-shadow:0 0 12px #3a6ee8;
      z-index:2;
    }
    .enemy {
      width:44px; height:44px; background:#e83a3a;
      border:3px solid #fff; box-shadow:0 0 12px #e83a3a;
      z-index:1;
      animation: enemyMove 1.2s infinite alternate;
    }
    @keyframes enemyMove { to { filter:brightness(1.2);} }
    .coin {
      width:32px; height:32px; background:gold;
      border:2px solid #fff; box-shadow:0 0 8px #ffe066;
      background-image: radial-gradient(circle at 60% 40%,#fff7 30%,transparent 70%);
      z-index:1;
    }
    .xp-bubble {
      width:24px; height:24px; background:#43e86e;
      border:2px solid #fff; box-shadow:0 0 8px #43e86e;
      z-index:1;
    }
    /* HUD */
    #hud-left {
      position:absolute; top:18px; left:24px; color:#fff; z-index:10;
      font-size:20px; line-height:1.6;
      text-shadow:0 2px 8px #000a;
    }
    #rank { font-size:16px; margin-top:8px; color:#ffe066;}
    #xp-bar-bg {
      position:absolute; bottom:28px; right:32px; width:260px; height:22px;
      background:#1a2340; border-radius:12px; border:1.5px solid #fff5;
      box-shadow:0 2px 8px #0006; z-index:10;
    }
    #xp-bar {
      height:100%; border-radius:12px; background:linear-gradient(90deg,#43e86e,#3a6ee8);
      width:0%;
      transition:width 0.3s;
    }
    #xp-label {
      position:absolute; bottom:54px; right:32px; color:#fff; font-size:15px; z-index:10;
      text-shadow:0 2px 8px #000a;
    }
    /* Succ√®s */
    #achievements {
      position:absolute; top:18px; right:28px; z-index:10; display:flex; align-items:center; gap:10px;
    }
    .trophy {
      width:32px; height:32px; border-radius:50%; background:#ccc;
      display:flex; align-items:center; justify-content:center;
      font-size:22px; color:#fff; box-shadow:0 2px 8px #0006;
      border:2px solid #fff8;
    }
    .bronze { background:linear-gradient(135deg,#b87333,#f1c27d);}
    .argent { background:linear-gradient(135deg,#bfc1c2,#f6f6f6);}
    .or { background:linear-gradient(135deg,#ffde59,#ffe066);}
    /* Pause/GameOver Modals */
    .modal-bg {
      display:none; position:absolute; left:0;top:0;right:0;bottom:0; background:rgba(0,0,0,0.7);
      z-index:100; align-items:center; justify-content:center;
    }
    .modal-bg.active { display:flex;}
    .modal {
      background:#232b3b; border-radius:22px; box-shadow:0 8px 32px #000b;
      padding:38px 28px 30px 28px; min-width:320px; text-align:center; position:relative;
      animation:popin 0.2s;
    }
    @keyframes popin { from{transform:scale(0.7);} to{transform:scale(1);} }
    .modal-title { font-size:28px; font-weight:bold; margin-bottom:28px; letter-spacing:1px;}
    .modal-btn {
      display:block; width:100%; margin:16px 0; padding:16px 0;
      font-size:20px; font-weight:bold; border:none; border-radius:10px;
      background:#3a6ee8; color:#fff; cursor:pointer; transition:background 0.15s;
    }
    .modal-btn:hover { background:#254a9c;}
    .modal-btn.quit { background:#e83a3a;}
    .modal-btn.quit:hover { background:#a81a1a;}
    .modal-btn.gold { background:#ffe066; color:#232b3b;}
    /* Responsive */
    @media (max-width:1000px) {
      #gameArea { width:98vw; height:80vw; max-width:98vw; max-height:80vw;}
    }
  </style>
</head>
<body>
<div id="gameArea">
  <!-- HUD -->
  <div id="hud-left">
    <div>Score : <span id="score">0</span></div>
    <div>ü™ô Pi√®ces : <span id="coins">0</span></div>
    <div id="rank">Rang : D√©butant</div>
  </div>
  <div id="achievements">
    <div class="trophy bronze" id="trophy" title="Difficult√© : Bronze">üèÜ</div>
    <span id="achv-label">Succ√®s</span>
  </div>
  <div id="xp-bar-bg">
    <div id="xp-bar"></div>
  </div>
  <div id="xp-label">XP : <span id="xp">0</span> / <span id="xp-max">100</span></div>
  <!-- Modals -->
  <div class="modal-bg" id="pauseModal">
    <div class="modal">
      <div class="modal-title">Pause</div>
      <button class="modal-btn" onclick="resumeGame()">Reprendre</button>
      <button class="modal-btn" onclick="restartGame()">Recommencer</button>
      <button class="modal-btn quit" onclick="quitToMenu()">Quitter</button>
    </div>
  </div>
  <div class="modal-bg" id="gameOverModal">
    <div class="modal">
      <div class="modal-title">GAME OVER</div>
      <button class="modal-btn gold" onclick="restartGame()">Recommencer</button>
      <button class="modal-btn quit" onclick="quitToMenu()">Quitter</button>
    </div>
  </div>
  <!-- Entities -->
  <div class="player" id="player"></div>
  <div class="enemy" id="enemy1"></div>
  <div class="enemy" id="enemy2"></div>
  <div class="coin" id="coin"></div>
  <div class="xp-bubble" id="xpBubble"></div>
</div>
<script>
/* --- Game State --- */
const area = document.getElementById('gameArea');
const player = document.getElementById('player');
const enemies = [document.getElementById('enemy1'), document.getElementById('enemy2')];
const coin = document.getElementById('coin');
const xpBubble = document.getElementById('xpBubble');
const scoreEl = document.getElementById('score');
const coinsEl = document.getElementById('coins');
const rankEl = document.getElementById('rank');
const xpBar = document.getElementById('xp-bar');
const xpEl = document.getElementById('xp');
const xpMaxEl = document.getElementById('xp-max');
const pauseModal = document.getElementById('pauseModal');
const gameOverModal = document.getElementById('gameOverModal');
const trophy = document.getElementById('trophy');
const achvLabel = document.getElementById('achv-label');

let width = area.clientWidth, height = area.clientHeight;
let px = width/2-24, py = height/2-24, ps = 6;
let ex = [100, width-100], ey = [100, height-100], evx = [3, -2.5], evy = [2.5, 3];
let coinPos = [200, 200], xpPos = [400, 400];
let score = 0, coins = 0, xp = 0, xpMax = 100;
let paused = false, gameOver = false;
let difficulty = "bronze"; // bronze, argent, or

// Rangs selon le nombre de pi√®ces
function getRank(n) {
  if (n >= 30) return "Ma√Ætre";
  if (n >= 20) return "Expert";
  if (n >= 10) return "Pro";
  if (n >= 5) return "Avanc√©";
  return "D√©butant";
}

// Succ√®s selon la difficult√©
function setDifficulty(diff) {
  difficulty = diff;
  if(diff==="bronze") { trophy.className="trophy bronze"; trophy.title="Difficult√© : Bronze"; achvLabel.textContent="Succ√®s"; }
  if(diff==="argent") { trophy.className="trophy argent"; trophy.title="Difficult√© : Argent"; achvLabel.textContent="Succ√®s"; }
  if(diff==="or") { trophy.className="trophy or"; trophy.title="Difficult√© : Or"; achvLabel.textContent="Succ√®s"; }
}
setDifficulty("bronze"); // Change ici pour tester argent/or

function placeRandom(el, margin=40) {
  let x = Math.random()*(width-margin*2)+margin;
  let y = Math.random()*(height-margin*2)+margin;
  el.style.left = x+"px";
  el.style.top = y+"px";
  return [x,y];
}
function updateEntities() {
  player.style.left = px+"px"; player.style.top = py+"px";
  enemies[0].style.left = ex[0]+"px"; enemies[0].style.top = ey[0]+"px";
  enemies[1].style.left = ex[1]+"px"; enemies[1].style.top = ey[1]+"px";
  coin.style.left = coinPos[0]+"px"; coin.style.top = coinPos[1]+"px";
  xpBubble.style.left = xpPos[0]+"px"; xpBubble.style.top = xpPos[1]+"px";
}
function updateHUD() {
  scoreEl.textContent = score;
  coinsEl.textContent = coins;
  rankEl.textContent = "Rang : "+getRank(coins);
  xpEl.textContent = xp;
  xpMaxEl.textContent = xpMax;
  xpBar.style.width = Math.min(100,100*xp/xpMax)+"%";
}
function resetGame() {
  px = width/2-24; py = height/2-24;
  ex[0]=100; ey[0]=100; ex[1]=width-100; ey[1]=height-100;
  evx=[3, -2.5]; evy=[2.5, 3];
  score=0; coins=0; xp=0; xpMax=100;
  gameOver=false; paused=false;
  coinPos = placeRandom(coin);
  xpPos = placeRandom(xpBubble, 30);
  updateEntities(); updateHUD();
  pauseModal.classList.remove('active');
  gameOverModal.classList.remove('active');
  area.focus();
}
function pauseGame() { if(!gameOver){ paused=true; pauseModal.classList.add('active');}}
function resumeGame() { paused=false; pauseModal.classList.remove('active'); area.focus();}
function quitToMenu() { location.reload(); /* √† remplacer par retour au menu principal */ }
function restartGame() { resetGame(); }
function showGameOver() { gameOver=true; gameOverModal.classList.add('active'); }

function rectsCollide(ax,ay,aw,ah,bx,by,bw,bh) {
  return ax<bx+bw && ax+aw>bx && ay<by+bh && ay+ah>by;
}

/* --- Game Loop --- */
let keys = {};
document.addEventListener('keydown', e=>{
  if(e.code==="Space") { if(!paused && !gameOver) pauseGame(); else if(paused) resumeGame(); }
  keys[e.code]=true;
});
document.addEventListener('keyup', e=>{ keys[e.code]=false; });

function gameLoop() {
  if(!paused && !gameOver) {
    // D√©placement joueur
    if(keys["ArrowLeft"]||keys["KeyA"]) px=Math.max(0,px-ps);
    if(keys["ArrowRight"]||keys["KeyD"]) px=Math.min(width-48,px+ps);
    if(keys["ArrowUp"]||keys["KeyW"]) py=Math.max(0,py-ps);
    if(keys["ArrowDown"]||keys["KeyS"]) py=Math.min(height-48,py+ps);

    // D√©placement ennemis (rebondissent)
    for(let i=0;i<enemies.length;i++) {
      ex[i]+=evx[i]; ey[i]+=evy[i];
      if(ex[i]<0||ex[i]>width-44) evx[i]*=-1;
      if(ey[i]<0||ey[i]>height-44) evy[i]*=-1;
    }

    // Collisions joueur/ennemi
    for(let i=0;i<enemies.length;i++) {
      if(rectsCollide(px,py,48,48,ex[i],ey[i],44,44)) {
        showGameOver();
        return;
      }
    }
    // Collisions joueur/pi√®ce
    if(rectsCollide(px,py,48,48,coinPos[0],coinPos[1],32,32)) {
      coins++; score+=10;
      coinPos = placeRandom(coin);
      updateHUD();
    }
    // Collisions joueur/bulle XP
    if(rectsCollide(px,py,48,48,xpPos[0],xpPos[1],24,24)) {
      xp+=20; score+=2;
      if(xp>=xpMax) { xp-=xpMax; xpMax+=50; score+=20; }
      xpPos = placeRandom(xpBubble, 30);
      updateHUD();
    }
    updateEntities();
  }
  requestAnimationFrame(gameLoop);
}
resetGame();
gameLoop();

/* --- Resize gestion --- */
window.addEventListener('resize', ()=>{
  width = area.clientWidth; height = area.clientHeight;
});

/* --- Pour changer la difficult√©, appelle setDifficulty("argent") ou "or" --- */
// setDifficulty("or"); // D√©commente pour tester le troph√©e or

</script>
</body>
</html>
